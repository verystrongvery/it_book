select 기반의 IO 멀티플렉싱이 느린 이유
- select 함수 호출 이후, 매번 모든 파일 디스크립터를 순회하면서 상태를 확인해야 합니다.
- select 함수 호출 이후, 매번 관찰 대상의 정보를 전달해야 합니다.
epoll의 장점
- 매번 모든 파일 디스크립터를 순회하지 않아도 됩니다.
- 매번 관찰 대상의 정보를 전달하지 않아도 됩니다.
epoll_create()
- 파일 디스크립터 저장소인 epoll 인스턴스를 생성합니다.
- epoll 인스턴스는 운영체제에 의해서 관리 됩니다.
epoll_ctl()
- epoll 인스턴스에 관찰대상이 되는 파일 디스크립터를 등록하거나 삭제합니다.
epoll_event 구조체
- __uint32_t events: 이벤트의 종류를 저장합니다.
- epoll_data_t data: 파일 디스크립터의 정보를 저장합니다.
epoll_event 구조체의 events에 저장 가능한 상수
- EPOLLIN: 수신할 데이터가 존재하는 상황을 의미 합니다.
- EPOLLOUT: 출력버퍼가 비워져서, 데이터를 전송할 수 있는 상황을 의미합니다.
- EPOLLPRI: OOB 데이터가 수신된 상황을 의미 합니다.
- EPOLLRDHUP: 연결이 종료되었거나 half-close가 진행된 상황을 의미 합니다.
- EPOLLERR: 에러가 발생한 상황을 의미 합니다.
- EPOLLET: 이벤트의 감지를 엣지 트리거 방식으로 동작시키는 것을 의미 합니다.
- EPOLLONESHOT: 이벤트가 한번 감지되면, 해당 파일 디스크립터에 대해서는 이벤트 감지를 중지하는 것을 의미합니다.
epoll_wait()
- epoll 인스턴스에 등록된 파일 디스크립터의 이벤트를 감지합니다.