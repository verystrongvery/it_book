네티의 세 가지 장점
- 네트워킹 전문가가 아니라도 네티로 네트워킹 애플리케이션을 쉽게 개발할 수 있습니다.
- 기본 자바 API를 직접 사용하는것 보다 쉽습니다.
- 바람직한 설계를 할 수 있습니다.
네티란
- 유지 관리가 용이한 고성능 프로토콜 서버와 클라이언트를 신속하게 개발할 수 있습니다.
- 비동기성 이벤트 기반 네트워크 어플리케이션 프레임워크 입니다.
최초의 자바 네트워킹 API인 java.net
- 블로킹 함수만 지원합니다.
- 새로운 클라이언트 소켓마다 새로운 스레드를 생성해야 합니다.
java.net 문제점
- 여러 스레드가 입력이나 출력 데이터가 들어오기를 기다리며 무한정 대기 상태로 유지될 수 있습니다.
- 각 스레드가 스택 메모리를 할당해야 하기 때문에, 리소스 낭비가 발생할 수 있습니다.
- 많은 스레드의 컨텍스트 전환에 따른 오버헤드가 발생할 수 있습니다.
네이티브 소켓 라이브러리
- 자바에서 소켓 프로그래밍을 위한 기본적인 네트워크 기능을 제공하는 라이브러리 입니다.
Stream
- 데이터가 들어온 순서대로 흘러다니는 단방향의 통로 입니다.
- 바이트 또는 바이트 배열로 데이터를 전송합니다.
- 블로킹 함수만 지원합니다.
- 데이터가 입력될 떄마다 즉시 전송합니다.
Buffer
- 임시로 데이터를 담을 수 있는 일종의 큐 입니다.
- 데이터를 중간에서 임시로 저장하고, 나중에 한꺼번에 전송합니다.
Channel
- 데이터가 흘러다니는 양방향의 통로 입니다.
- 입력과 출력을 구분하지 않습니다.
- 기본적으로 버퍼를 통해서만 데이터 읽기 및 쓰기를 수행합니다.
- 블로킹 함수와 논블로킹 함수를 모두 지원합니다.
자바 IO
- 입출력 방식: 스트림
- 버퍼 방식: 넌버퍼
- 비동기 방식: 지원안함
자바 NIO
- 입출력 방식: 채널
- 버퍼 방식: 버퍼
- 비동기 방식: 지원함
멀티플렉싱
- 여러 채널(다중 입력)을 하나의 셀렉터(단일 출력)로 제어하는 기술을 의미합니다.
폴링
- 일정한 주기로 다른 장치의 상태를 확인하는 방식을 의미 합니다.
셀렉터
- 여러 채널의 상태를 모니터링하고, 상태가 바뀐 채널을 찾아내는 역할을 합니다.
셀렉터 생성
- open()을 호출하여 셀렉터를 생성합니다.
셀렉터에 채널 등록
- register()를 호출하여 채널을 셀렉터에 등록합니다.
- register()는 SelectionKey를 반환합니다.
- 인자값으로 interest set을 전달하여 어떤 이벤트를 모니터링 할지 지정합니다.
- 셀렉터에 등록하기 위한 채널은 SelectableChannel의 서브 클래스이어야 하고, 논블로킹 모드로 설정되어야 합니다.
SelectionKey: interest set
- 셀렉터에 등록된 채널이 어떤 이벤트를 모니터링 할지 지정한 이벤트 집합 입니다.
- interestOps() 메서드 호출로 값을 조회할 수 있습니다.
SelectionKey: ready set
- 셀렉터에 등록된 채널에서 발생한 이벤트 집합 입니다.
- readyOps() 메서드 호출로 값을 조회할 수 있습니다.
Selector.select()
- interest set에 등록된 이벤트가 발생할 때까지 블로킹됩니다.
Selector.selecttedKeys()
- select() 메서드가 반환되면, 하나 이상의 채널이 준비 되었다는 것을 의미합니다.
- 해당 메소드는 준비된 채널을 Set<SelectionKey> 형태로 반환 합니다.
- Set<SelectionKey>는 이터레이터를 통해 하나씩 접근할 수 있습니다.
Selector.wakeup()
- select() 메서드가 블로킹 상태일 때, 즉시 반환하도록 합니다.
Selector.close()
- 셀렉터를 닫습니다.